<html>
	<head>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/reveal.css') }}">
		<link rel="stylesheet" href="{{ url_for('static', filename='css/theme/moon.css') }}">
		<!-- <link rel="stylesheet" href="{{ url_for('static', filename='css/tivac3.css') }}"> -->
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
          <h3>TIVA models</h3>
          <br>
          <h6>As easy as</h6>
          <p>
            <br>
            <i>A</i>e<sup>-&alpha;t</sup> + <i>B</i>e<sup>-&beta;t</sup> + <i>C</i>e<sup>-&theta;t</sup>
          </p>
        </section>
				<section>
          <section>
            <h3>Basics</h3>
            <br>
            <h6>for a bolus:</h6>
            <br>
            <p>Cp = Dose / Vd </p>
          </section>
          <section>
            <h6>infusion</h6>
            <br>
            <p>Cp = rate / Cl </p>
          </section>
        </section>
				<section>
					<h2>How it looks</h2>
					<p>plasma concetration after a bolus</p>
					<br>
					<div id="chart" style="fill:#93a1a1;font-size:20px;"></div>
					<br>
				</section>
        <section>
          <section>
            <h2>Propofol</h2>
            <br>
            <p>3 Compartments....</p>
            <br>
            <p align="left">
              <b>Central (V1):</b>
              <span class="fragment visible" data-fragment-index="1">Intravascular</span>
              <br>
              <br>
              <b>Fast (V2):</b>
              <span class="fragment visible" data-fragment-index="2">Well perfused tissue</span>
              <span class="fragment visible" data-fragment-index="3"> <i>e.g. muscle</i></span>
              <br>
              <br>
              <b>Slow (V3):</b>
              <span class="fragment visible" data-fragment-index="4">Poorly perfused</span>
              <span class="fragment visible" data-fragment-index="5"> <i>e.g. fat</i></span>
              <br>
              <br>
            </p>
          </section>
          <section>
            <h2>Rate constants</h2>
            <svg width="550" height="250">
              <rect x="0" y="20" rx="20" ry="20" width="150" height="150" style="fill:orange;stroke:black;stroke-width:3;opacity:0.5" />
              <rect x="200" y="20" rx="20" ry="20" width="150" height="150" style="fill:yellow;stroke:black;stroke-width:3;opacity:0.5" />
              <rect x="400" y="20" rx="20" ry="20" width="150" height="150" style="fill:orange;stroke:black;stroke-width:3;opacity:0.5" />
              <rect x="150" y="120" width="50" height="20" style="fill:blue;stroke:black;stroke-width:3;opacity:0.5" />
              <rect x="350" y="120" width="50" height="20" style="fill:red;stroke:black;stroke-width:3;opacity:0.5" />
              <rect x="265" y="170" width="20" height="50" style="fill:green;stroke:black;stroke-width:3;opacity:0.5" />
            </svg>
            <p align="left">
              Between: <br>
                <span class="fragment highlight-blue visible" data-fragment-index="1">- V1 and V2</span><br>
                <span class="fragment highlight-red visible" data-fragment-index="2">- V1 and V3</span><br>
                <span class="fragment highlight-green visible" data-fragment-index="3">- Clearance from V1</span>
            </p>
          </section>
					<section>
						<h2>The fourth compartment</h2>
						<br>
						<p>Propofol doesn't work intravascularly</p>
						<img src="{{ url_for('static', filename='img/effect.png') }}" />
					</section>
					<section>
						<h2>Practicalities of Effect site targeting</h2>
						<br>
						<p>
							<ul>
								<li>Lag time between Central and effect compartment</li>
								<li>Significant plasma overshoot</li>
								<li>Overshoot varies with clearance</li>
								<li>Effect site will lag behind plasma when stopping</li>
							</ul>
						</p>
					</section>
        </section>
				<section>
					<h2>The Models</h2>
					<br>
					<h6>Marsh & Schnider</h6>
					<p>Makeup:</p>
					<ul>
						<li>24 (Schnider)</li>
						<li>19 (Gepts)</li>
						<li>70% male</li>
					</ul>
				</section>
				<section>
					<h2>A second chart!</h2>
					<br>
					<p>
						Do your patients look like this?
					<div id="chart2" style="fill:#93a1a1;fill-opactity:0.2;font-size:20px;"></div>
					<br>
				</p>
				</section>
				<section>
					<section>
						<h2>Differences</h2>
						<br>
						<table style="font-size:20px;color:#d33682;">
							<tr>
								<th>Model</th>
								<th>V1</th>
								<th>V2</th>
								<th>V3</th>
								<th>K10</th>
							</tr>
							<tr>
								<td>Marsh</td>
								<td>0.228/Kg</td>
								<td>0.463/Kg</td>
								<td>2.893/Kg</td>
								<td>0.119</td>
							</tr>
							<tr>
								<td>Schnider</td>
								<td class="fragment highlight-green visible" data-fragment-index="1">4.27</td>
								<td>18.9-0.391x(age-53)</td>
								<td>238</td>
								<td>0.443+0.0107×(weight−77)−0.0159×(<span class="fragment highlight-green" data-fragment-index="2">LBM</span>−59)+0.0062×(height−177)</td>
							</tr>
						</table>
					</section>
					<section>
						<h2>Some examples</h2>
						Age: <input type='number' value="40" name="age">
						Weight: <input type='number' value="70" name="weight">
						Height: <input type='number' value="170" name="height">

					</section>
				</section>
				<section>
						<h2>The James equation</h2>
						<h6>achilles heel of schnider?</h6>
						<p>Equation for lean body mass</p>
						<p>Paradoxical decrease with high weights
						<br>&#8756; increase in k10</p>
				</section>
				<section>
						<h2>Result?</h2>
						<img src="{{ url_for('static', filename='img/james.jpg') }}" />
				</section>
				<section>
					<h2>The Future?</h2>
					<div id="chart3" style="fill:#93a1a1;fill-opactity:0.2;font-size:20px;"></div>
				</section>
			</div>
		</div>
		<script src="{{ url_for('static', filename='js/reveal.js') }}"></script>
    <script src="{{ url_for('static', filename='js/c3.js') }}"></script>
    <script src="{{ url_for('static', filename='js/d3.min.js') }}"></script>
		<script>
			Reveal.initialize();
      var chart = c3.generate({
        bindto: '#chart',
        data: {
          // xs: {
          //   'Calc': 'time',
					// 	'CP': 'time',
          //   'Effect site': 'time2',
          // },
					x: 'time',
          columns: [
            ['time', 0, 2.11, 4.01, 8.06, 16.03, 30.05, 59.73, ],
						['Calc', 0, 3.95,	1.33,	0.684,	0.526,	0.352,	0.17],
            ['CP', 0, 3.62, 1.33, 0.676, 0.338, 0.204, 0.11, ],
					//	['time2', 0, 2,	4,	6,	8,	10,	20,	30,	40,	50,	60,],
          	//['Effect site', 0,	1.71,	2.37,	2.67,	1.62,	2.13,	4.11,	5.05,	5.18,	4.47,	4.29, ]

          ],
          type: 'area-spline',
        },
				area: {
					opacity: 50,
					color: '#ffffff',
				},
        axis: {
          x: {
            padding: {
              right: 10,
            },
            tick: {
            culling: {
                max: 4 // the number of tick texts will be adjusted to less than this value
            }

            // for normal axis, default on
            // for category axis, default off
            },
            label: {
              text: 'time (mins)',
              position:'outer-left',
            },
          },
          y: {
            tick: {
              culling: {
                max: 5 // the number of tick texts will be adjusted to less than this value
            }
            // for normal axis, default on
            // for category axis, default off
          },
            label: {
              text: 'Plasma Concentration',
              position:'outer-middle',
            },
          }
        }
      });
			var chart2 = c3.generate({
				bindto: '#chart2',
				data: {
					xs: {
						'schnider': 'schnider_w',
						'marsh': 'marsh_w',
						'BMI25': '25_x',
						'BMI30': '30_x'
					},
					columns:[
						["schnider", 157.5, 195.6, 170.2, 181.6, 182.9, 175.3, 170.2, 188, 182.2, 177.8, 182.9, 167.6, 188, 177.8, 167.6, 175.3, 177.8, 170.2, 180.3, 157.5, 180.3, 172.7, 160, 154.9 ],
						["schnider_w", 46.3, 122.7, 79.4, 79.4, 74.8, 62.6, 64.4, 74.8, 93.4, 90.7, 88.4, 64.4, 95.2, 88.4, 44.7, 79.8, 74.8, 70.3, 91.2, 63.5, 86.2, 88.4, 70.3, 44.4 ],
						["marsh", 178, 173, 151, 178, 171, 159, 166, 168, 174, 173, 169, 175, 162, 161, 176 ],
						["marsh_w", 74, 73, 54, 75, 63, 48, 55, 49, 76, 80, 74, 78, 63, 65, 84],
						["BMI25", 140, 160, 180, 200 ],
						["25_x", 49, 64, 81, 100],
						["BMI30", 140, 160, 180, 200 ],
						["30_x", 58.8, 76.8, 97.2, 120],
					],
					types: {
						'schnider': 'scatter',
						'marsh': 'scatter',
						'BMI25': 'spline',
					},
				},
				axis: {
					x: {
						padding: {
							right: 10,
						},
						tick: {
						culling: {
								max: 5 // the number of tick texts will be adjusted to less than this value
						}

						// for normal axis, default on
						// for category axis, default off
						},
						label: {
							text: 'Weight (Kg)',
							position:'outer-right',
						},
					},
				}
			});
			chart2.toggle(['BMI25', 'BMI30']);

			var chart3 = c3.generate({
				bindto: '#chart3',
				data: {
					// xs: {
					// 	'schnider': 'schnider_w',
					//
					// },
					columns:[
						['run1', 0.999550201386051,0.999368750223689,0.999360454303747,0.99271939816726,0.975135808036158,0.97058803466608,0.955030042330962,0.955030042330962,0.955030042330962,0.955030042330962,0.937812240706462,0.877232673395957,0.858554899549261,0.781113496182913,0.74905522799507,0.730318235710624,0.482064554549227,0.472607676991516,0.437530804139288,0.408425073311467,0.36521175546059,0.350143050151472,0.326926129869436,0.306177379240975,0.292235145770442,0.292235145770442,0.291723007960448,0.291723007960448,],
						['run2', 0.987355470776045,0.987355470776045,0.984042839700726,0.983965187519292,0.962779503661838,0.946448090927969,0.844752598624521,0.69185895630056,0.577798357853803,0.478622866605079,0.440192238126153,0.406167821656789,0.281790292732143,0.248450345479128,0.248450345479128,0.246461030155581,0.23051515576793,0.23051515576793,0.23051515576793,0.23051515576793,0.23051515576793,0.23051515576793,0.229915311159635,0.229297849057807,0.229297849057807,0.229297849057807,0.229297849057807,0.229297849057807, ],
						['run3', 0.995673612045256,0.995526825080222,0.99342672606791,0.991147776381486,0.989243217954967,0.981943540080361,0.968585391617025,0.94985384860228,0.946442362439174,0.936449128560284,0.914257084066309,0.911816003849285,0.842398188818135,0.820070990611316,0.820070990611316,0.820070990611316,0.779368367346999,0.779368367346999,0.773558522986847,0.769809680930045,0.664269221517155,0.613933018787405,0.587055864795482,0.470428665217725,0.402872672402707,0.342876601932376,0.321802769315096,0.312100555555294,0.296375289566981,0.296202109115662,0.295320047295032,0.293020755788516,0.288492302489855,0.286114369598837,0.280333111024062,0.273412131684564,0.265668496419119,0.26371732931876,0.262731668131712,0.262731668131712,0.253362275661719,0.253362275661719,0.252078475573747,0.252078475573747,0.252078475573747,0.252078475573747,0.252078475573747,0.252078475573747,0.252078475573747,0.252078475573747,0.252078475573747,0.252078475573747,0.252078475573747,0.252078475573747,0.252078475573747,0.252078475573747,0.252078475573747,0.252078475573747,0.252078475573747,0.250009647436398,0.250009647436398,0.250009647436398,0.250009647436398,0.250009647436398,0.250009647436398,0.249027378275827,0.249027378275827,0.249027378275827,0.249027378275827,0.249027378275827,0.249027378275827,0.249027378275827,0.249027378275827,0.249027378275827,0.248025871025194,0.248025871025194,0.246686849156274,0.246686849156274,0.246686849156274,0.244037291809027,0.244037291809027,0.243828444980875,0.243828444980875,0.243828444980875,0.243828444980875,0.238897900857874,0.238897900857874,0.238463960058742,0.238463960058742,0.238463960058742,0.238463960058742,0.238463960058742,0.238463960058742,0.238463960058742,0.238463960058742,0.238463960058742,0.238463960058742,0.238463960058742,0.238463960058742,0.238463960058742],
						['run4', 0.939012087292384,0.939012087292384,0.937666502286341,0.907778340144228,0.907062084231425,0.888597123150219,0.864354575157982,0.808622606819161,0.738842010628902,0.738842010628902,0.588680900885244,0.538157997515469,0.459645435378912,0.459645435378912,0.459645435378912,0.357122859343454,0.334041826795519,0.32553549672859,0.321173702015532,0.312150270404173,0.284338194553916,0.277615107789945,0.271101289533223,0.271101289533223,0.271101289533223,0.271101289533223,0.269336376461268,0.263305733297956,0.257165732631013,0.251814094765893,0.251617774775543,0.251617774775543,0.251016376040854,0.251016376040854,0.251016376040854,0.251016376040854,0.251016376040854,0.251016376040854,0.251016376040854,0.251016376040854,0.251016376040854,0.251016376040854,0.251016376040854,0.250741047588893,0.250741047588893,0.250741047588893,0.247638502856123,0.246665371197761,0.246665371197761,0.24659969967078,0.24659969967078,0.24659969967078,0.24659969967078,0.24659969967078,0.24659969967078,0.24659969967078,0.24659969967078,0.24659969967078,0.24659969967078,0.24659969967078,0.24659969967078,0.24659969967078,0.24659969967078,0.244971442713539,0.244971442713539,0.243544055004796,0.243544055004796,0.243544055004796,0.243544055004796,0.243544055004796,0.243544055004796,0.243544055004796,0.243544055004796,0.243544055004796,0.243544055004796,0.243544055004796,0.242453901134675,0.241955291990382,0.241955291990382,0.241955291990382,0.241955291990382,0.241955291990382,0.241955291990382,0.241955291990382,0.241955291990382,0.241955291990382,0.241907696434749,0.241627035786736,0.240734258782433,0.240734258782433,0.240734258782433,0.240734258782433,0.240734258782433,0.240734258782433,0.240734258782433,0.240734258782433,],
						['run5', 0.79049161591322,0.761748820755996,0.718009083852993,0.522064023079037,0.519031574102135,0.502525326515549,0.484763861417342,0.426148452070913,0.389178674759607,0.374657022553112,0.369840299355786,0.367719830662742,0.357150498065746,0.349310966491685,0.332140815429421,0.332140815429421,0.32675380349528,0.320795534072248,0.320795534072248,0.320795534072248,0.315990793819574,0.312185454680924,0.279536445232964,0.263900578396757,0.250207569889972,0.248286847762794,0.24139000887312,0.24139000887312,0.24139000887312,0.24139000887312,0.24139000887312,0.24139000887312,0.240774289304288,0.239801680702163,0.239801680702163,0.236191500193535,0.235268602716017,0.235268602716017,0.235268602716017,0.235268602716017,0.235268602716017,0.235268602716017,0.235268602716017,0.235268602716017,0.232796616057514,0.232796616057514,0.232796616057514,0.229410202787015,0.229410202787015,0.229410202787015,0.229410202787015,0.228772357437158,0.227257093102545,0.227257093102545,0.227257093102545,0.227257093102545,0.227257093102545,0.227257093102545,0.227257093102545,0.227016823840615,0.227016823840615,0.226974706637459,0.226974706637459,0.226014531936611,0.226014531936611,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.224513057579362,0.22353453279474,0.22353453279474,0.22353453279474,0.22353453279474,0.22353453279474,0.22353453279474],
						['run6',0.995929179639595,0.992487557044626,0.989117493688351,0.988155697322047,0.988155697322047,0.96699082230345,0.950095343342619,0.946509301596303,0.922519703082942,0.843472920249101,0.843472920249101,0.831664483459115,0.806769384027396,0.801660244137388,0.77573410579621,0.659022638020192,0.573341495115352,0.545438368474905,0.505294103054366,0.505294103054366,0.499584352814015,0.479095479728923,0.43644550585133,0.386659771016368,0.361998617537627,0.336177612173507,0.297567863511758,0.297567863511758,0.294221760342116,0.285659595314756,0.272505390693685,0.272505390693685,0.272505390693685,0.262670387518446,0.253639096582196,0.237391662135996,0.237391662135996,0.237391662135996,0.233620665486323,0.23247434739907,0.225228279878769,0.225228279878769,0.221044511748293,0.221044511748293,0.221044511748293,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.219177496241251,0.21917749624125],
						['run7',0.998873175982073,0.998282959501263,0.994208745931334,0.989572019052803,0.988586553781151,0.951998214008379,0.902963913639996,0.890678531478936,0.852521726183125,0.798672840693487,0.684207146124929,0.668778736965689,0.622307549842154,0.52924349149203,0.52924349149203,0.439765367168853,0.436251512788374,0.436251512788374,0.395558196499711,0.331801013239014,0.30830671942408,0.305542408411956,0.298724724837179,0.279033036131242,0.258535939826593,0.258535939826593,0.258376668864364,0.256265594617943,0.256265594617943,0.256265594617943,0.256265594617943,0.251466785923239,0.249753752660526,0.249753752660526,0.249753752660526,0.244928112315636,0.244776143573568,0.24474949756409,0.243816179794857,0.243816179794857,0.24344465984378,0.240985653125925,0.240985653125925,0.240733685831327,0.240733685831327,0.239719739731988,0.239719739731988,0.238904527708019,0.238904527708019,0.238707673355434,0.23697584729256,0.235100585823196,0.233662814786221,0.233489017251456,0.22881553205174,0.227805756155329,0.227805756155329,0.227583614035521,0.227583614035521,0.227583614035521,0.227583614035521,0.227583614035521,0.227583614035521,0.226380752580583,0.225718695209713,0.225718695209713,0.225718695209713,0.225311175018874,0.225033916579415,0.223820890972919,0.223820890972919,0.223820890972919,0.223820890972919,0.223820890972919,0.223820890972919,0.22368960160883,0.223136079704077,0.223136079704077,0.223136079704077,0.223136079704077,0.223136079704077,0.223136079704077,0.223136079704077,0.223136079704077,0.223136079704077,0.223136079704077,0.223136079704077,0.223136079704077,0.223136079704077,0.223136079704077,0.223136079704077,0.223136079704077,0.223136079704077,0.223136079704077,0.223136079704077,0.22290510152098,0.222110488558232,0.222110488558232,0.222110488558232,0.222110488558232]
					],
					type: 'scatter',
				},
			});
		</script>
	</body>
</html>
